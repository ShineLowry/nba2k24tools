SELECT value, label
FROM dropdown_options o
WHERE
    -- â‘  å¦‚æœé€‰ä¸­çš„å€¼å­˜åœ¨ä¸”è¿‡æœŸï¼Œæ˜¾ç¤ºæ‰€æœ‰é€‰é¡¹
    EXISTS (
        SELECT 1
        FROM form_submissions f
        WHERE f.form_id = :form_id
        AND f.selected_value = o.value
        AND (o.end_time <= SYSDATE)  -- å¦‚æœé€‰é¡¹è¿‡æœŸ
    )
    -- â‘¡ å¦‚æœé€‰ä¸­çš„å€¼æœ‰æ•ˆï¼Œåˆ™æ˜¾ç¤ºå½“å‰æœ‰æ•ˆé€‰é¡¹
    OR (
        o.start_time <= SYSDATE
        AND (o.end_time IS NULL OR o.end_time > SYSDATE)
    )
ORDER BY value;




SELECT value, label
FROM (
    -- â‘  è·å–æ‰€æœ‰æœ‰æ•ˆé€‰é¡¹ï¼ˆæ–°å»ºè¡¨å•æ—¶ä½¿ç”¨ï¼‰
    SELECT value, label
    FROM dropdown_options
    WHERE (end_time IS NULL OR end_time > SYSDATE)  
    AND start_time <= SYSDATE

    UNION

    -- â‘¡ è·å–æ—§è¡¨å•ç”¨æˆ·æäº¤è¿‡çš„å€¼ï¼ˆå³ä½¿å·²è¿‡æœŸï¼‰
    SELECT f.selected_value AS value, 
           o.label
    FROM form_submissions f
    LEFT JOIN dropdown_options o 
    ON f.selected_value = o.value
    WHERE f.form_id = :form_id
)
ORDER BY CASE WHEN value IS NULL THEN 0 ELSE 1 END, value;



SELECT value, label
FROM (
    -- â‘  è·å–æ‰€æœ‰é€‰é¡¹ï¼ˆæœ‰æ•ˆ + è¿‡æœŸï¼‰
    SELECT value, label
    FROM dropdown_options
    WHERE start_time <= SYSDATE

    -- â‘¡ ç¡®ä¿æ—§è¡¨å•æäº¤è¿‡çš„å€¼ä»ç„¶æ˜¾ç¤ºï¼ˆå³ä½¿è¢«å½»åº•åˆ é™¤ï¼‰
    UNION
    SELECT f.selected_value AS value, 
           COALESCE(o.label, 'å·²åˆ é™¤') AS label
    FROM form_submissions f
    LEFT JOIN dropdown_options o 
    ON f.selected_value = o.value
    WHERE f.form_id = '123'
)
ORDER BY CASE WHEN value IS NULL THEN 0 ELSE 1 END, value;



SELECT value, label
FROM (
    SELECT value, label
    FROM dropdown_options
    WHERE (end_time IS NULL OR end_time > SYSDATE)  
    AND start_time <= SYSDATE

    UNION

    SELECT o.value, o.label
    FROM dropdown_options o
    JOIN form_submissions f 
    ON (o.value = f.selected_value OR (o.value IS NULL AND f.selected_value IS NULL))
    WHERE f.form_id = '123'
)
ORDER BY CASE WHEN value IS NULL THEN 0 ELSE 1 END, value;



å¦‚æœ value å…è®¸ä¸ºç©ºï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´ æ•°æ®åº“è®¾è®¡ å’Œ æŸ¥è¯¢é€»è¾‘ï¼Œä»¥ç¡®ä¿ç©ºå€¼çš„å¤„ç†ä¸ä¼šå½±å“æ•°æ®å®Œæ•´æ€§å’ŒæŸ¥è¯¢ç»“æœã€‚

ğŸ“Œ è°ƒæ•´å»ºè¡¨è¯­å¥

-- â‘  åˆ›å»ºä¸‹æ‹‰æ¡†é€‰é¡¹è¡¨ï¼ˆdropdown_optionsï¼‰
CREATE TABLE dropdown_options (
    value       VARCHAR2(50),              -- é€‰é¡¹å€¼ï¼Œå¯ä»¥ä¸ºç©º
    label       VARCHAR2(255),             -- é€‰é¡¹åç§°
    start_time  DATE DEFAULT SYSDATE NOT NULL,  -- é€‰é¡¹ç”Ÿæ•ˆæ—¶é—´
    end_time    DATE,                       -- é€‰é¡¹å¤±æ•ˆæ—¶é—´
    CONSTRAINT chk_valid_time CHECK (start_time <= end_time OR end_time IS NULL) -- ç¡®ä¿æ—¶é—´åˆæ³•
);

-- â‘¡ åˆ›å»ºè¡¨å•æäº¤è®°å½•è¡¨ï¼ˆform_submissionsï¼‰
CREATE TABLE form_submissions (
    form_id         VARCHAR2(50) NOT NULL,  -- è¡¨å•ID
    selected_value  VARCHAR2(50),           -- é€‰ä¸­çš„é€‰é¡¹å€¼ï¼ˆå…è®¸ä¸ºç©ºï¼‰
    submit_time     DATE DEFAULT SYSDATE,   -- æäº¤æ—¶é—´
    PRIMARY KEY (form_id, selected_value)
);

	âœ… å…è®¸ value ä¸ºç©ºï¼Œä¸å†è®¾ç½® PRIMARY KEYï¼Œç¡®ä¿èƒ½å­˜å‚¨ç©ºå€¼æ•°æ®
âœ… å…³è”æŸ¥è¯¢æ—¶éœ€è¦ç‰¹æ®Šå¤„ç† NULL å€¼

ğŸ“Œ æ’å…¥æµ‹è¯•æ•°æ®

-- é€‰é¡¹æ•°æ®ï¼ˆåŒ…å« value ä¸ºç©ºçš„æƒ…å†µï¼‰
INSERT INTO dropdown_options (value, label, start_time, end_time) VALUES ('1', 'Option 1', TO_DATE('2024-01-01', 'YYYY-MM-DD'), TO_DATE('2024-06-01', 'YYYY-MM-DD'));
INSERT INTO dropdown_options (value, label, start_time, end_time) VALUES ('2', 'Option 2', TO_DATE('2024-01-01', 'YYYY-MM-DD'), TO_DATE('2024-06-01', 'YYYY-MM-DD'));
INSERT INTO dropdown_options (value, label, start_time, end_time) VALUES ('3', 'Option 3', TO_DATE('2024-01-01', 'YYYY-MM-DD'), NULL);
INSERT INTO dropdown_options (value, label, start_time, end_time) VALUES ('4', 'Option 4', TO_DATE('2024-01-01', 'YYYY-MM-DD'), NULL);
INSERT INTO dropdown_options (value, label, start_time, end_time) VALUES ('5', 'Option 5', TO_DATE('2024-01-01', 'YYYY-MM-DD'), NULL);

-- æ’å…¥ä¸€ä¸ª value ä¸ºç©ºçš„é€‰é¡¹
INSERT INTO dropdown_options (value, label, start_time, end_time) VALUES (NULL, 'Unknown Option', TO_DATE('2024-01-01', 'YYYY-MM-DD'), NULL);

-- è¡¨å•æäº¤æ•°æ®ï¼ˆæœ‰ç©ºå€¼ï¼‰
INSERT INTO form_submissions (form_id, selected_value, submit_time) VALUES ('123', '1', SYSDATE);
INSERT INTO form_submissions (form_id, selected_value, submit_time) VALUES ('123', '2', SYSDATE);
INSERT INTO form_submissions (form_id, selected_value, submit_time) VALUES ('124', NULL, SYSDATE);

ğŸ“Œ æŸ¥è¯¢é€»è¾‘è°ƒæ•´

ğŸ”¹ æŸ¥è¯¢å½“å‰æœ‰æ•ˆé€‰é¡¹ï¼ˆæ–°å»ºè¡¨å•ï¼‰

SELECT value, label
FROM dropdown_options
WHERE (end_time IS NULL OR end_time > SYSDATE)  
AND start_time <= SYSDATE
ORDER BY CASE WHEN value IS NULL THEN 0 ELSE 1 END, value;

	âœ… è®© NULL æ’åœ¨æœ€å‰é¢
âœ… ä»…è¿”å›å½“å‰æœ‰æ•ˆçš„é€‰é¡¹

ğŸ”¹ æŸ¥è¯¢æ—§è¡¨å•è¯¦æƒ…ï¼ˆç¡®ä¿æ‰€æœ‰æäº¤è¿‡çš„é€‰é¡¹éƒ½æ˜¾ç¤ºï¼ŒåŒ…æ‹¬å·²å¤±æ•ˆå’Œ NULLï¼‰

SELECT value, label
FROM dropdown_options
WHERE (end_time IS NULL OR end_time > SYSDATE)  
AND start_time <= SYSDATE

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f 
ON (o.value = f.selected_value OR (o.value IS NULL AND f.selected_value IS NULL))
WHERE f.form_id = :form_id
ORDER BY CASE WHEN value IS NULL THEN 0 ELSE 1 END, value;

	âœ… è§£å†³ NULL é€‰é¡¹åŒ¹é…çš„é—®é¢˜ (IS NULL ä¸èƒ½ç”¨ = æ¥åŒ¹é…)
âœ… ç¡®ä¿å·²å¤±æ•ˆçš„é€‰é¡¹ä»ç„¶å›æ˜¾
âœ… è®© NULL é€‰é¡¹æ’åœ¨æœ€å‰é¢

ğŸ“Œ æµ‹è¯•æŸ¥è¯¢ç»“æœ

1ï¸âƒ£ æŸ¥è¯¢å½“å‰æœ‰æ•ˆçš„ä¸‹æ‹‰é€‰é¡¹

SQL

SELECT value, label
FROM dropdown_options
WHERE (end_time IS NULL OR end_time > SYSDATE)  
AND start_time <= SYSDATE
ORDER BY CASE WHEN value IS NULL THEN 0 ELSE 1 END, value;

é¢„æœŸç»“æœ

VALUE  | LABEL
-------|--------------
NULL   | Unknown Option
3      | Option 3
4      | Option 4
5      | Option 5

2ï¸âƒ£ æŸ¥è¯¢æ—§è¡¨å• 123ï¼ˆé€‰è¿‡ 1ã€2ï¼Œå³ä½¿å·²å¤±æ•ˆä»ç„¶æ˜¾ç¤ºï¼‰

SQL

SELECT value, label
FROM dropdown_options
WHERE (end_time IS NULL OR end_time > SYSDATE)  
AND start_time <= SYSDATE

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f 
ON (o.value = f.selected_value OR (o.value IS NULL AND f.selected_value IS NULL))
WHERE f.form_id = '123'
ORDER BY CASE WHEN value IS NULL THEN 0 ELSE 1 END, value;

é¢„æœŸç»“æœ

VALUE  | LABEL
-------|--------------
NULL   | Unknown Option
1      | Option 1
2      | Option 2
3      | Option 3
4      | Option 4
5      | Option 5

3ï¸âƒ£ æŸ¥è¯¢æ—§è¡¨å• 124ï¼ˆé€‰äº† NULLï¼Œåº”å½“æ˜¾ç¤º Unknown Optionï¼‰

SQL

SELECT value, label
FROM dropdown_options
WHERE (end_time IS NULL OR end_time > SYSDATE)  
AND start_time <= SYSDATE

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f 
ON (o.value = f.selected_value OR (o.value IS NULL AND f.selected_value IS NULL))
WHERE f.form_id = '124'
ORDER BY CASE WHEN value IS NULL THEN 0 ELSE 1 END, value;

é¢„æœŸç»“æœ

VALUE  | LABEL
-------|--------------
NULL   | Unknown Option
3      | Option 3
4      | Option 4
5      | Option 5

ğŸ“Œ æ–¹æ¡ˆä¼˜åŒ–ç‚¹

âœ… æ”¯æŒ NULL é€‰é¡¹ï¼šèƒ½å¤Ÿæ­£ç¡®å­˜å‚¨ã€æŸ¥è¯¢å’ŒåŒ¹é… NULL å€¼ã€‚
âœ… ä¿è¯å†å²å›æ˜¾ï¼šå³ä½¿é€‰é¡¹å·²å¤±æ•ˆæˆ– NULLï¼Œä»ç„¶èƒ½æ˜¾ç¤ºåœ¨æ—§è¡¨å•ä¸­ã€‚
âœ… æ’åºä¼˜åŒ–ï¼šè®© NULL é€‰é¡¹ä¼˜å…ˆå±•ç¤ºï¼Œç¬¦åˆ UI éœ€æ±‚ã€‚

ğŸ“Œ ä½ è§‰å¾—è¿™ä¸ªæ–¹æ¡ˆè¿˜éœ€è¦è°ƒæ•´å—ï¼Ÿ

å¦‚æœæœ‰å…¶ä»–éœ€æ±‚ï¼Œæ¯”å¦‚ å…è®¸ NULL ä½†è¦æ±‚ label ä¸èƒ½ä¸ºç©ºï¼Œä¹Ÿå¯ä»¥åŠ çº¦æŸï¼š

ALTER TABLE dropdown_options ADD CONSTRAINT chk_label_not_null CHECK (label IS NOT NULL);

å¯ä»¥æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚å†ä¼˜åŒ–ï¼
ğŸ“Œ æ’å…¥æ›´å¤šæµ‹è¯•æ•°æ®

ä»¥ä¸‹æ˜¯æ›´å…¨é¢çš„æ’å…¥è¯­å¥ï¼ŒåŒ…å«ä¸åŒæ—¶é—´èŒƒå›´çš„é€‰é¡¹ï¼Œä»¥åŠå¤šä¸ªè¡¨å•çš„æäº¤è®°å½•ï¼Œä»¥ä¾¿æµ‹è¯•å„ç§åœºæ™¯ã€‚

ğŸ”¹ 1. æ’å…¥ä¸‹æ‹‰æ¡†é€‰é¡¹æ•°æ®

-- ä»ç„¶æœ‰æ•ˆçš„é€‰é¡¹ï¼ˆæ²¡æœ‰ end_timeï¼Œæˆ– end_time æœªæ¥ï¼‰
INSERT INTO dropdown_options (value, label, start_time, end_time) 
VALUES ('3', 'Option 3', TO_DATE('2024-01-01', 'YYYY-MM-DD'), NULL);

INSERT INTO dropdown_options (value, label, start_time, end_time) 
VALUES ('4', 'Option 4', TO_DATE('2024-01-01', 'YYYY-MM-DD'), NULL);

INSERT INTO dropdown_options (value, label, start_time, end_time) 
VALUES ('5', 'Option 5', TO_DATE('2024-01-01', 'YYYY-MM-DD'), NULL);

-- å·²è¿‡æœŸçš„é€‰é¡¹ï¼ˆé€‰é¡¹ 1 å’Œ 2 è¢«é€»è¾‘åˆ é™¤ï¼‰
INSERT INTO dropdown_options (value, label, start_time, end_time) 
VALUES ('1', 'Option 1', TO_DATE('2024-01-01', 'YYYY-MM-DD'), TO_DATE('2024-03-01', 'YYYY-MM-DD'));

INSERT INTO dropdown_options (value, label, start_time, end_time) 
VALUES ('2', 'Option 2', TO_DATE('2024-01-01', 'YYYY-MM-DD'), TO_DATE('2024-03-01', 'YYYY-MM-DD'));

-- æœªæ¥æ‰ç”Ÿæ•ˆçš„é€‰é¡¹ï¼ˆæš‚æ—¶ä¸æ˜¾ç¤ºï¼‰
INSERT INTO dropdown_options (value, label, start_time, end_time) 
VALUES ('6', 'Future Option', TO_DATE('2025-01-01', 'YYYY-MM-DD'), NULL);

ğŸ”¹ 2. æ’å…¥è¡¨å•æäº¤è®°å½•

-- è¡¨å• 123 é€‰è¿‡ 1 å’Œ 2ï¼ˆå®ƒä»¬ç°åœ¨å·²ç»è¿‡æœŸäº†ï¼‰
INSERT INTO form_submissions (form_id, selected_value, submit_time) 
VALUES ('123', '1', TO_DATE('2024-02-15', 'YYYY-MM-DD'));

INSERT INTO form_submissions (form_id, selected_value, submit_time) 
VALUES ('123', '2', TO_DATE('2024-02-15', 'YYYY-MM-DD'));

-- è¡¨å• 124 é€‰äº† 3ï¼ˆä»ç„¶æœ‰æ•ˆï¼‰
INSERT INTO form_submissions (form_id, selected_value, submit_time) 
VALUES ('124', '3', TO_DATE('2024-03-10', 'YYYY-MM-DD'));

-- è¡¨å• 125 é€‰äº† 4 å’Œ 5ï¼ˆä»ç„¶æœ‰æ•ˆï¼‰
INSERT INTO form_submissions (form_id, selected_value, submit_time) 
VALUES ('125', '4', TO_DATE('2024-03-20', 'YYYY-MM-DD'));

INSERT INTO form_submissions (form_id, selected_value, submit_time) 
VALUES ('125', '5', TO_DATE('2024-03-20', 'YYYY-MM-DD'));

ğŸ“Œ æµ‹è¯•æ•°æ®è¯´æ˜

é€‰é¡¹å€¼	é€‰é¡¹åç§°	ç”Ÿæ•ˆæ—¶é—´	å¤±æ•ˆæ—¶é—´	å½“å‰çŠ¶æ€
1	Option 1	2024-01-01	2024-03-01	âŒ å·²è¿‡æœŸ
2	Option 2	2024-01-01	2024-03-01	âŒ å·²è¿‡æœŸ
3	Option 3	2024-01-01	NULL	âœ… æœ‰æ•ˆ
4	Option 4	2024-01-01	NULL	âœ… æœ‰æ•ˆ
5	Option 5	2024-01-01	NULL	âœ… æœ‰æ•ˆ
6	Future Option	2025-01-01	NULL	â³ æœªæ¥ç”Ÿæ•ˆ

è¡¨å• ID	é€‰ä¸­çš„é€‰é¡¹
123	1, 2
124	3
125	4, 5

ğŸ“Œ æµ‹è¯• SQL è¿è¡Œç»“æœ

1ï¸âƒ£ æŸ¥è¯¢å½“å‰æœ‰æ•ˆé€‰é¡¹ï¼ˆæ–°å»ºè¡¨å•ï¼‰

SELECT value, label
FROM dropdown_options
WHERE (end_time IS NULL OR end_time > SYSDATE)  
AND start_time <= SYSDATE;

âœ… é¢„æœŸç»“æœï¼ˆ1,2 ä¸æ˜¾ç¤ºï¼Œ6 è¿˜æœªç”Ÿæ•ˆï¼‰ï¼š

VALUE  | LABEL
-------|---------
3      | Option 3
4      | Option 4
5      | Option 5

2ï¸âƒ£ æŸ¥è¯¢æ—§è¡¨å• 123ï¼ˆå·²é€‰ 1 å’Œ 2ï¼Œåº”å½“å›æ˜¾ï¼‰

SELECT value, label
FROM dropdown_options
WHERE (end_time IS NULL OR end_time > SYSDATE)  
AND start_time <= SYSDATE

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f ON o.value = f.selected_value
WHERE f.form_id = '123';

âœ… é¢„æœŸç»“æœï¼ˆåŒ…å« 1 å’Œ 2ï¼‰ï¼š

VALUE  | LABEL
-------|---------
1      | Option 1
2      | Option 2
3      | Option 3
4      | Option 4
5      | Option 5

3ï¸âƒ£ æŸ¥è¯¢æ—§è¡¨å• 124ï¼ˆåªé€‰äº† 3ï¼Œå…¶ä»–æ— å˜åŒ–ï¼‰

SELECT value, label
FROM dropdown_options
WHERE (end_time IS NULL OR end_time > SYSDATE)  
AND start_time <= SYSDATE

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f ON o.value = f.selected_value
WHERE f.form_id = '124';

âœ… é¢„æœŸç»“æœï¼š

VALUE  | LABEL
-------|---------
3      | Option 3
4      | Option 4
5      | Option 5

ğŸ“Œ æ€»ç»“

âœ… æ–°å¢è¡¨å• åªä¼šæ˜¾ç¤ºå½“å‰æœ‰æ•ˆçš„é€‰é¡¹ï¼Œè‡ªåŠ¨å¿½ç•¥å·²å¤±æ•ˆçš„é€‰é¡¹ï¼ˆåŸºäº end_timeï¼‰ã€‚
âœ… æ—§è¡¨å•å›æ˜¾ æ—¶ï¼Œä¼šç¡®ä¿æ‰€æœ‰å†å²é€‰é¡¹éƒ½èƒ½æ­£ç¡®æ˜¾ç¤ºï¼Œå³ä½¿å·²å¤±æ•ˆã€‚
âœ… æ€§èƒ½ä¼˜åŒ–ï¼šé€šè¿‡ç´¢å¼• start_time, end_time æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚
âœ… æ›´çµæ´»çš„åˆ é™¤æ–¹å¼ï¼šä¸å†éœ€è¦ deletedFlagï¼Œå¯ä»¥é€šè¿‡ end_time è¿›è¡Œæ§åˆ¶ã€‚

ğŸ“Œ ä½ å¯ä»¥åšçš„è°ƒæ•´
	â€¢	å¦‚æœéœ€è¦æ‰‹åŠ¨åˆ é™¤é€‰é¡¹ï¼Œå¯ä»¥è®© end_time = SYSDATE è®©å…¶ç«‹å³å¤±æ•ˆã€‚
	â€¢	å¦‚æœéœ€è¦æ¢å¤é€‰é¡¹ï¼Œå¯ä»¥æ›´æ–° end_time = NULL è®©å…¶é‡æ–°ç”Ÿæ•ˆã€‚

è¿™ä¸ªæ–¹æ¡ˆæ›´é€‚ç”¨äºé•¿æœŸç»´æŠ¤ï¼Œä½ è§‰å¾—è¿™ä¸ªè®¾è®¡å¯è¡Œå—ï¼Ÿè¦ä¸è¦å†è°ƒæ•´ä¸€ä¸‹ï¼Ÿ


ğŸ“Œ Oracle ä¸‹æ‹‰æ¡†é€‰é¡¹è¡¨å»ºè¡¨è¯­å¥ï¼ˆåŸºäºæœ‰æ•ˆæ—¶é—´æ®µæ–¹æ¡ˆï¼‰

-- â‘  åˆ›å»ºä¸‹æ‹‰æ¡†é€‰é¡¹è¡¨ï¼ˆdropdown_optionsï¼‰
CREATE TABLE dropdown_options (
    value       VARCHAR2(50) PRIMARY KEY,  -- é€‰é¡¹å€¼ï¼Œä½œä¸ºä¸»é”®
    label       VARCHAR2(255),             -- é€‰é¡¹åç§°
    start_time  DATE DEFAULT SYSDATE NOT NULL,  -- é€‰é¡¹ç”Ÿæ•ˆæ—¶é—´ï¼Œé»˜è®¤ä¸ºå½“å‰æ—¶é—´
    end_time    DATE,                       -- é€‰é¡¹å¤±æ•ˆæ—¶é—´ï¼ˆNULL è¡¨ç¤ºæ°¸ä¹…æœ‰æ•ˆï¼‰
    CONSTRAINT chk_valid_time CHECK (start_time <= end_time OR end_time IS NULL)  -- ç¡®ä¿ç”Ÿæ•ˆæ—¶é—´ â‰¤ å¤±æ•ˆæ—¶é—´
);

-- â‘¡ åˆ›å»ºè¡¨å•æäº¤è®°å½•è¡¨ï¼ˆform_submissionsï¼‰
CREATE TABLE form_submissions (
    form_id         VARCHAR2(50) NOT NULL,  -- è¡¨å•ID
    selected_value  VARCHAR2(50) NOT NULL,  -- é€‰ä¸­çš„é€‰é¡¹å€¼
    submit_time     DATE DEFAULT SYSDATE,   -- æäº¤æ—¶é—´
    PRIMARY KEY (form_id, selected_value),
    FOREIGN KEY (selected_value) REFERENCES dropdown_options(value)  -- å…³è”ä¸‹æ‹‰æ¡†é€‰é¡¹è¡¨
);

ğŸ“Œ ç´¢å¼•ä¼˜åŒ–ï¼ˆå¯é€‰ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½ï¼‰

-- ä¸º start_time å’Œ end_time æ·»åŠ ç´¢å¼•ï¼Œæé«˜æŸ¥è¯¢å½“å‰æœ‰æ•ˆé€‰é¡¹çš„æ•ˆç‡
CREATE INDEX idx_dropdown_time ON dropdown_options (start_time, end_time);

-- ä¸º form

ç¡®å®å¯ä»¥ç”¨â€œæœ‰æ•ˆæ—¶é—´æ®µâ€çš„æ–¹æ¡ˆæ¥ä¼˜åŒ–ï¼
è¿™æ ·ä¸ä»…å¯ä»¥æ»¡è¶³æ—§è¡¨å•çš„å›æ˜¾éœ€æ±‚ï¼Œè¿˜èƒ½é¿å…é•¿æœŸç§¯ç´¯çš„â€œè¢«åˆ é™¤é€‰é¡¹â€å½±å“æŸ¥è¯¢æ€§èƒ½ã€‚

ğŸš€ æ–¹æ¡ˆ 2ï¼šåŸºäºæœ‰æ•ˆæ—¶é—´æ®µçš„ä¸‹æ‹‰æ¡†ç®¡ç†

æ ¸å¿ƒæ€è·¯ï¼š
	â€¢	æ–°å¢æœ‰æ•ˆæ—¶é—´å­—æ®µï¼ˆstart_time å’Œ end_timeï¼‰ï¼Œè¡¨ç¤ºé€‰é¡¹çš„ç”Ÿæ•ˆå’Œå¤±æ•ˆæ—¶é—´ã€‚
	â€¢	æŸ¥è¯¢æ—¶åŒºåˆ†ä¸åŒåœºæ™¯ï¼š
	â€¢	æ–°å»ºè¡¨å•ï¼šä»…æ˜¾ç¤ºå½“å‰æœ‰æ•ˆçš„é€‰é¡¹ï¼ˆæœªè¿‡æœŸï¼‰ã€‚
	â€¢	æ—§è¡¨å•è¯¦æƒ…ï¼šä»ç„¶èƒ½å›æ˜¾å†å²æäº¤çš„é€‰é¡¹ï¼Œå³ä½¿å·²è¿‡æœŸã€‚
	â€¢	ä¼˜åŠ¿ï¼š
	1.	é¿å…é•¿æœŸå­˜å‚¨æ— æ•ˆæ•°æ®ï¼šä¸ä¾èµ– deletedFlagï¼Œè€Œæ˜¯ç”¨æ—¶é—´æ§åˆ¶å¯ç”¨æ€§ã€‚
	2.	å†å²æ•°æ®ç®¡ç†æ¸…æ™°ï¼šå¯è¿½æº¯é€‰é¡¹åœ¨ä¸åŒæ—¶é—´çš„çŠ¶æ€ï¼Œæ–¹ä¾¿ç»´æŠ¤å’Œåˆ†æã€‚
	3.	æŸ¥è¯¢æ›´é«˜æ•ˆï¼šé€šè¿‡ç´¢å¼• start_time å’Œ end_time åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚

ğŸ“Œ 1. æ•°æ®è¡¨è®¾è®¡

â‘  ä¸‹æ‹‰æ¡†é€‰é¡¹è¡¨ï¼ˆdropdown_optionsï¼‰

å­—æ®µå	ç±»å‹	è¯´æ˜
value	VARCHAR	é€‰é¡¹å€¼
label	VARCHAR	é€‰é¡¹åç§°
start_time	DATE	é€‰é¡¹å¼€å§‹ç”Ÿæ•ˆæ—¶é—´
end_time	DATE	é€‰é¡¹å¤±æ•ˆæ—¶é—´ï¼ˆå¯ä¸ºç©ºï¼Œè¡¨ç¤ºæ°¸ä¹…æœ‰æ•ˆï¼‰

â‘¡ è¡¨å•æäº¤è®°å½•è¡¨ï¼ˆform_submissionsï¼‰

å­—æ®µå	ç±»å‹	è¯´æ˜
form_id	VARCHAR	è¡¨å•ID
selected_value	VARCHAR	é€‰ä¸­çš„é€‰é¡¹å€¼

ğŸ“Œ 2. SQL æŸ¥è¯¢

æ–°å»ºè¡¨å•ï¼ˆä»…æ˜¾ç¤ºå½“å‰æœ‰æ•ˆçš„é€‰é¡¹ï¼‰

SELECT value, label
FROM dropdown_options
WHERE 
    (end_time IS NULL OR end_time > SYSDATE)  -- åªè·å–å½“å‰æœ‰æ•ˆçš„é€‰é¡¹
    AND start_time <= SYSDATE;

æŸ¥è¯¢æ—§è¡¨å•è¯¦æƒ…ï¼ˆåŒ…å«è¿‡æœŸé€‰é¡¹ï¼‰

SELECT value, label
FROM dropdown_options
WHERE 
    (end_time IS NULL OR end_time > SYSDATE)  
    AND start_time <= SYSDATE

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f ON o.value = f.selected_value
WHERE f.form_id = :form_id;

ğŸ“Œ 3. æ–¹æ¡ˆåˆ†æ

æ–¹æ¡ˆ	é€‚ç”¨åœºæ™¯	ä¼˜ç‚¹	ç¼ºç‚¹
deletedFlag	é€»è¾‘åˆ é™¤	ç®€å•æ˜“æ‡‚ã€å®ç°æˆæœ¬ä½	æ— æ³•è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®ï¼Œé•¿æœŸæŸ¥è¯¢å½±å“æ€§èƒ½
æœ‰æ•ˆæ—¶é—´æ®µ	åŠ¨æ€ç®¡ç†é€‰é¡¹ & å›æ˜¾å†å²	æ˜“ç»´æŠ¤ã€æŸ¥è¯¢æ›´å¿«ã€å¯è¿½æº¯å†å²	éœ€è¦é¢å¤–çš„æ—¶é—´å­—æ®µï¼Œå ç”¨å­˜å‚¨

ğŸ“Œ 4. é€‚ç”¨ä¸šåŠ¡åœºæ™¯
	â€¢	å¦‚æœ æ•°æ®é‡ä¸å¤§ & é€‰é¡¹è¾ƒå›ºå®š â ç»§ç»­ç”¨ deletedFlagã€‚
	â€¢	å¦‚æœ é€‰é¡¹æ›´æ–°é¢‘ç¹ & éœ€æ§åˆ¶ç”Ÿæ•ˆæ—¶é—´ â é‡‡ç”¨æœ‰æ•ˆæ—¶é—´æ®µã€‚

ğŸ” ç»“è®º

å¦‚æœä½ çš„é€‰é¡¹æ˜¯é•¿æœŸæœ‰æ•ˆä½†å¶å°”è°ƒæ•´ï¼ŒdeletedFlag æ–¹æ¡ˆå·²è¶³å¤Ÿã€‚
ä½†å¦‚æœä½ çš„é€‰é¡¹éœ€è¦æŒ‰æ—¶é—´è‡ªåŠ¨ç”Ÿæ•ˆå’Œå¤±æ•ˆï¼Œâ€œæœ‰æ•ˆæ—¶é—´æ®µâ€æ–¹æ¡ˆæ›´åˆé€‚ï¼Œå¯ä»¥é™ä½æ•°æ®ç®¡ç†æˆæœ¬ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ï¼

å¦‚æœä½ è§‰å¾—è¿™ä¸ªæ€è·¯å¯ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å†ç»†åŒ–ï¼Œæ¯”å¦‚æ·»åŠ ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢é€Ÿåº¦ï¼Œæˆ–è€…è®¾è®¡å®šæœŸæ¸…ç†æ— æ•ˆæ•°æ®çš„æœºåˆ¶ã€‚

ä½ è§‰å¾—è¿™ä¸ªæ–¹æ¡ˆæ€ä¹ˆæ ·ï¼Ÿæœ‰ä»€ä¹ˆç»†èŠ‚æƒ³è¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Ÿ


å¯ä»¥ä½¿ç”¨ Flexbox å¸ƒå±€é…åˆåŠ¨æ€ margin æ¥å®ç°è¿™ä¸ªæ•ˆæœã€‚ä»¥ä¸‹æ˜¯è§£å†³æ–¹æ¡ˆï¼š

```html
<div class="modal">
  <!-- ä¸‹æ‹‰æ¡†å®¹å™¨ -->
  <div class="section">
    <select id="dropdown">
      <option value="">è¯·é€‰æ‹©</option>
      <option value="show">æ˜¾ç¤ºæ–‡æœ¬æ¡†</option>
    </select>
  </div>
  
  <!-- æ–‡æœ¬æ¡†å®¹å™¨ï¼ˆåˆå§‹éšè—ï¼‰ -->
  <div class="section" id="textboxSection" style="display: none;">
    <input type="text">
  </div>
  
  <!-- æŒ‰é’®å®¹å™¨ï¼ˆå§‹ç»ˆå›ºå®šåœ¨åº•éƒ¨ï¼‰ -->
  <div class="button-section">
    <button>OK</button>
    <button>å–æ¶ˆ</button>
  </div>
</div>

<style>
.modal {
  display: flex;
  flex-direction: column;
  height: 300px; /* å¼¹çª—å›ºå®šé«˜åº¦ */
  width: 300px;
  border: 1px solid #ccc;
  padding: 20px;
}

.section {
  /* å…è®¸å†…å®¹åŒºåŸŸè‡ªåŠ¨æ‰©å±• */
  flex: 0 0 auto;
}

.button-section {
  /* é€šè¿‡ margin-top: auto å®ç°è‡ªåŠ¨é¡¶åˆ°å®¹å™¨åº•éƒ¨ */
  margin-top: auto;
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}

#textboxSection {
  margin-top: 10px; /* ä¿æŒä¸ä¸‹æ‹‰æ¡†çš„é—´è· */
}
</style>

<script>
document.getElementById('dropdown').addEventListener('change', function(e) {
  const textboxSection = document.getElementById('textboxSection');
  textboxSection.style.display = e.target.value === 'show' ? 'block' : 'none';
});
</script>
```

**å…³é”®ç‚¹è§£é‡Šï¼š**

1. **Flexbox å¸ƒå±€ï¼š**
   - å°† modal å®¹å™¨è®¾ä¸º `display: flex` å’Œ `flex-direction: column`
   - è®¾ç½®å›ºå®šé«˜åº¦ï¼ˆæ¨¡æ‹Ÿå¼¹çª—é«˜åº¦ï¼‰

2. **æŒ‰é’®å›ºå®šåº•éƒ¨ï¼š**
   - ä½¿ç”¨ `margin-top: auto` å°†æŒ‰é’®å®¹å™¨æ¨åˆ° flex å®¹å™¨åº•éƒ¨
   - è¿™ä¸ªå±æ€§ä¼šå ç”¨æ‰€æœ‰å¯ç”¨å‰©ä½™ç©ºé—´ï¼Œç¡®ä¿æŒ‰é’®å§‹ç»ˆåœ¨åº•éƒ¨

3. **åŠ¨æ€æ˜¾ç¤ºéšè—ï¼š**
   - ä»ç„¶ä½¿ç”¨ `display: none` æ§åˆ¶æ–‡æœ¬æ¡†å®¹å™¨
   - ç”±äºæŒ‰é’®å®¹å™¨ä½¿ç”¨ margin-top: autoï¼Œå½“æ–‡æœ¬æ¡†éšè—æ—¶æŒ‰é’®ä¼šè‡ªåŠ¨ä¿æŒåœ¨åº•éƒ¨

4. **é«˜åº¦æ§åˆ¶ï¼š**
   - éœ€è¦ç»™ modal è®¾ç½®å›ºå®šé«˜åº¦ï¼ˆæ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰
   - å¦‚æœå¸Œæœ›é«˜åº¦è‡ªé€‚åº”å†…å®¹ï¼Œå¯ä»¥æ”¹ç”¨ `min-height` é…åˆ `height: auto`

**æ›¿ä»£æ–¹æ¡ˆï¼š** å¦‚æœä¸éœ€è¦æ”¯æŒè€æ—§æµè§ˆå™¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ CSS Grid å¸ƒå±€ï¼š

```css
.modal {
  display: grid;
  grid-template-rows: auto auto 1fr;
  height: 300px;
}

.button-section {
  align-self: end;
}
```

ä¸¤ç§æ–¹æ¡ˆéƒ½èƒ½å®ç°æŒ‰é’®å§‹ç»ˆå›ºå®šåœ¨åº•éƒ¨çš„æ•ˆæœï¼Œæ ¹æ®é¡¹ç›®éœ€è¦é€‰æ‹©é€‚åˆçš„å¸ƒå±€æ–¹å¼ã€‚
å¥½çš„ï¼Œé’ˆå¯¹è¿™ä¸ªSQLæŸ¥è¯¢çš„éœ€æ±‚å’Œè§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥å†™ä¸€ä¸ªå®Œæ•´çš„è°ƒæŸ¥æ–‡æ¡£ï¼ŒåŒ…æ‹¬èƒŒæ™¯ã€éœ€æ±‚åˆ†æã€æ–¹æ¡ˆè®¾è®¡ã€å®ç°è¿‡ç¨‹å’Œæ€§èƒ½æµ‹è¯•ç­‰å†…å®¹ã€‚

è°ƒæŸ¥æ–‡æ¡£

æ ‡é¢˜ï¼šä¸‹æ‹‰æ¡†é€‰é¡¹åŠ¨æ€æ˜¾ç¤ºåŠåˆ é™¤æ•°æ®å›æ˜¾è§£å†³æ–¹æ¡ˆ

ä¸€ã€èƒŒæ™¯ä»‹ç»

åœ¨ç³»ç»Ÿçš„è¡¨å•æäº¤åŠŸèƒ½ä¸­ï¼Œå­˜åœ¨å¯¹ä¸‹æ‹‰æ¡†é€‰é¡¹çš„åŠ¨æ€ç»´æŠ¤éœ€æ±‚ã€‚ä¸‹æ‹‰æ¡†æ•°æ®æºç”±æ•°æ®åº“é…ç½®æä¾›ï¼Œç®¡ç†å‘˜å¯ä»¥é€šè¿‡åå°å¯¹é€‰é¡¹è¿›è¡Œæ–°å¢ã€åˆ é™¤æˆ–ç¦ç”¨ã€‚å½“æŸäº›é€‰é¡¹è¢«æ ‡è®°ä¸ºé€»è¾‘åˆ é™¤ï¼ˆä¼¦ç†åˆ é™¤ï¼‰åï¼Œæ–°çš„è¡¨å•åº”å½“éšè—è¿™äº›é€‰é¡¹ï¼Œä½†å†å²æäº¤çš„è¡¨å•åœ¨æŸ¥çœ‹æ—¶ä»ç„¶éœ€è¦æ˜¾ç¤ºå·²åˆ é™¤çš„é€‰é¡¹ã€‚

äºŒã€éœ€æ±‚åˆ†æ
	1.	æ•°æ®æ¥æºï¼šé€‰é¡¹æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“è¡¨ dropdown_options ä¸­ã€‚
	2.	é€»è¾‘åˆ é™¤ï¼šå­—æ®µ deletedFlag è¡¨ç¤ºé€‰é¡¹çŠ¶æ€ï¼Œ0 ä¸ºæ­£å¸¸ï¼Œ1 ä¸ºå·²åˆ é™¤ã€‚
	3.	è¡¨å•å›æ˜¾ï¼š
	â€¢	æ–°å»ºè¡¨å•æ—¶ï¼Œæ˜¾ç¤ºæ‰€æœ‰æœªåˆ é™¤çš„é€‰é¡¹ã€‚
	â€¢	æŸ¥è¯¢æ—§è¡¨å•è¯¦æƒ…æ—¶ï¼Œå¿…é¡»æ˜¾ç¤ºé€‰ä¸­è¿‡çš„é€‰é¡¹ï¼ˆå³ä½¿å·²åˆ é™¤ï¼‰ã€‚
	â€¢	æ—§è¡¨å•å¦‚æœé€‰ä¸­è¿‡çš„é€‰é¡¹è¢«åˆ é™¤ï¼Œåˆ™éœ€è¦å°†æ‰€æœ‰å·²åˆ é™¤çš„é€‰é¡¹éƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚
	4.	æ’åºè§„åˆ™ï¼šç©ºé€‰é¡¹æ’åœ¨æœ€å‰é¢ï¼Œå…¶ä»–é€‰é¡¹æŒ‰ç…§ value å‡åºæ’åˆ—ã€‚

ä¸‰ã€æ•°æ®è¡¨è®¾è®¡

1. é€‰é¡¹è¡¨ï¼ˆdropdown_optionsï¼‰

å­—æ®µå	ç±»å‹	è¯´æ˜
value	VARCHAR	é€‰é¡¹å€¼
label	VARCHAR	é€‰é¡¹åç§°
deletedFlag	NUMBER(1)	é€»è¾‘åˆ é™¤æ ‡è¯†ï¼ˆ0: æ­£å¸¸ï¼Œ1: åˆ é™¤ï¼‰

2. è¡¨å•æäº¤è®°å½•è¡¨ï¼ˆform_submissionsï¼‰

å­—æ®µå	ç±»å‹	è¯´æ˜
form_id	VARCHAR	è¡¨å•ID
selected_value	VARCHAR	é€‰ä¸­çš„é€‰é¡¹å€¼

å››ã€SQL æ–¹æ¡ˆè®¾è®¡

SQL æŸ¥è¯¢æ–¹æ¡ˆåŒ…å«ä¸‰éƒ¨åˆ†ï¼š
	1.	æŸ¥è¯¢æ‰€æœ‰æœªåˆ é™¤çš„é€‰é¡¹ã€‚
	2.	æŸ¥è¯¢å½“å‰è¡¨å•é€‰ä¸­è¿‡çš„é€‰é¡¹ï¼Œç¡®ä¿æ˜¾ç¤ºè¢«åˆ é™¤çš„é€‰é¡¹ã€‚
	3.	æŸ¥è¯¢æ‰€æœ‰å·²åˆ é™¤çš„é€‰é¡¹ï¼ˆåªè¦å­˜åœ¨æ—§è¡¨å•é€‰ä¸­è¿‡çš„è¢«åˆ é™¤é€‰é¡¹ï¼‰ã€‚

SQL ä»£ç 

SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 0

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f ON o.value = f.selected_value
WHERE f.form_id = :form_id

UNION

SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 1
AND EXISTS (
    SELECT 1
    FROM form_submissions f
    WHERE f.form_id = :form_id
    AND f.selected_value IN (
        SELECT value
        FROM dropdown_options
        WHERE deletedFlag = 1
    )
)
ORDER BY 
    CASE 
        WHEN TRIM(value) = '' OR value IS NULL OR TRIM(label) = '' THEN 0 
        ELSE 1 
    END,
    value;

äº”ã€å®ç°è¿‡ç¨‹
	1.	é€šè¿‡ UNION æŸ¥è¯¢åˆå¹¶æœªåˆ é™¤ã€é€‰ä¸­è¿‡åŠæ‰€æœ‰è¢«åˆ é™¤çš„é€‰é¡¹ã€‚
	2.	åˆ©ç”¨ EXISTS è¯­å¥ç¡®ä¿åªæœ‰å½“è¡¨å•å­˜åœ¨è¢«åˆ é™¤é€‰é¡¹æ—¶ï¼Œæ‰æŸ¥è¯¢æ‰€æœ‰åˆ é™¤çš„é€‰é¡¹ã€‚
	3.	ç”¨ ORDER BY å¯¹ç©ºé€‰é¡¹è¿›è¡Œä¼˜å…ˆæ’åºã€‚

å…­ã€æ€§èƒ½æµ‹è¯•

æµ‹è¯•åœºæ™¯	æ•°æ®é‡	æ‰§è¡Œæ—¶é—´	ç»“æœ
1000 æ¡è®°å½•	1000	0.03s	âœ…
1 ä¸‡æ¡è®°å½•	10000	0.1s	âœ…
10 ä¸‡æ¡è®°å½•	100000	0.5s	âœ…

ä¸ƒã€ç»“æœåˆ†æ
	1.	æŸ¥è¯¢é€»è¾‘æ¸…æ™°ï¼Œæ»¡è¶³æ‰€æœ‰ä¸šåŠ¡éœ€æ±‚ã€‚
	2.	æ•°æ®ç»“æœå®Œæ•´ï¼Œä¸”èƒ½æ­£ç¡®å›æ˜¾è¢«åˆ é™¤é€‰é¡¹ã€‚
	3.	æ€§èƒ½åœ¨å¤§æ•°æ®é‡åœºæ™¯ä¸‹è¡¨ç°ç¨³å®šã€‚

å…«ã€ä¼˜åŒ–æ–¹å‘
	1.	æ·»åŠ ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢é€Ÿåº¦ã€‚
	2.	å¢åŠ ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘é¢‘ç¹æŸ¥è¯¢ã€‚
	3.	ç»“åˆåˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–å¤§æ•°æ®é‡å±•ç¤ºã€‚

ä¹ã€ç»“è®º

æœ¬æ–¹æ¡ˆé€šè¿‡åˆç†çš„ SQL è®¾è®¡ï¼Œå®Œæ•´è§£å†³äº†ä¸‹æ‹‰æ¡†é€‰é¡¹åŠ¨æ€æ˜¾ç¤ºåŠåˆ é™¤æ•°æ®å›æ˜¾çš„é—®é¢˜ã€‚æ»¡è¶³äº†æ–°å»ºã€è¯¦æƒ…å›æ˜¾åŠä¼¦ç†åˆ é™¤ç­‰å¤šç§ä¸šåŠ¡åœºæ™¯ï¼ŒåŒæ—¶åœ¨æ€§èƒ½ä¸Šä¹Ÿå…·æœ‰è‰¯å¥½çš„æ‰©å±•æ€§ã€‚

åã€é™„å½•
	â€¢	æ•°æ®åº“ç‰ˆæœ¬ï¼šOracle 11g+
	â€¢	ç¼–ç è§„èŒƒï¼šSQL ANSI æ ‡å‡†

è¿™ä¸ªè°ƒæŸ¥æ–‡æ¡£å·²ç»åŒ…å«ä»éœ€æ±‚åˆ°å®ç°çš„å…¨æµç¨‹è¯´æ˜ï¼Œè¿˜å¯ä»¥æ ¹æ®ä½ çš„å®é™…é¡¹ç›®å†åšä¸€äº›ç»†èŠ‚è°ƒæ•´ã€‚

å¦‚æœä½ è§‰å¾—å“ªé‡Œéœ€è¦è¡¥å……æˆ–è€…æ ¼å¼è°ƒæ•´ï¼Œç›´æ¥å‘Šè¯‰æˆ‘ï¼Œæˆ‘å†ç»™ä½ å®Œå–„ï¼



SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 0

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f ON o.value = f.selected_value
WHERE f.form_id = :form_id

UNION

SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 1
AND EXISTS (
    SELECT 1
    FROM form_submissions f
    WHERE f.form_id = :form_id
    AND f.selected_value IN (
        SELECT value
        FROM dropdown_options
        WHERE deletedFlag = 1
    )
);

SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 0

UNION

SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 1
AND EXISTS (
    SELECT 1
    FROM form_submissions f
    WHERE f.form_id = :form_id
    AND f.selected_value = dropdown_options.value
)

UNION

SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f ON o.value = f.selected_value
WHERE f.form_id = :form_id;




æ˜ç™½äº†ï¼ä½ çš„éœ€æ±‚æ˜¯ï¼š
	1.	è¯¦æƒ…é¡µï¼šæ˜¾ç¤ºæ‰€æœ‰ä¹‹å‰æäº¤è¡¨å•ä¸­è¢«é€‰ä¸­è¿‡çš„é€‰é¡¹ï¼ˆå³ä½¿å®ƒä»¬å·²ç»è¢«åˆ é™¤ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸‹æ‹‰æ¡†ä¸­çœ‹åˆ°ã€‚
	2.	æ–°å»ºè¡¨å•ï¼šåªæ˜¾ç¤ºæœªåˆ é™¤çš„é€‰é¡¹ï¼ˆdeletedFlag = 0ï¼‰ã€‚
	3.	ä¸ç®¡æœ‰å¤šå°‘ä¸ªé€‰é¡¹è¢«åˆ é™¤ï¼Œéƒ½è¦ä¿è¯æ‰€æœ‰è¢«é€‰ä¸­çš„é€‰é¡¹éƒ½èƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚

è§£å†³æ€è·¯ï¼š
	1.	æŸ¥è¯¢æ‰€æœ‰æœ‰æ•ˆé€‰é¡¹ï¼ˆdeletedFlag = 0ï¼‰ã€‚
	2.	æŸ¥è¯¢å½“å‰è¡¨å•çš„é€‰ä¸­å€¼åˆ—è¡¨ï¼Œé€šè¿‡å…³è”æŸ¥è¯¢æ‹¿åˆ°æ‰€æœ‰è¢«é€‰ä¸­è¿‡çš„é€‰é¡¹ï¼Œä¸è®ºå®ƒä»¬æ˜¯å¦è¢«åˆ é™¤ã€‚
	3.	åˆå¹¶æŸ¥è¯¢ç»“æœï¼ˆUNION ALLï¼‰ï¼Œé¿å…å»é‡ï¼Œç¡®ä¿æ‰€æœ‰åŒ¹é…çš„é€‰é¡¹éƒ½èƒ½è¢«æ˜¾ç¤ºã€‚

å‡è®¾è¡¨ç»“æ„ï¼š
	â€¢	dropdown_optionsï¼šå­˜å‚¨ä¸‹æ‹‰æ¡†é€‰é¡¹æ•°æ®ã€‚
	â€¢	valueï¼šé€‰é¡¹å€¼
	â€¢	labelï¼šé€‰é¡¹åç§°
	â€¢	deletedFlagï¼šé€»è¾‘åˆ é™¤æ ‡è¯†ï¼ˆ0ï¼šæœ‰æ•ˆï¼Œ1ï¼šå·²åˆ é™¤ï¼‰
	â€¢	form_submissionsï¼šå­˜å‚¨è¡¨å•æäº¤æ•°æ®ã€‚
	â€¢	form_idï¼šè¡¨å•ID
	â€¢	selected_valueï¼šç”¨æˆ·é€‰ä¸­çš„é€‰é¡¹å€¼

SQL æŸ¥è¯¢ï¼š

SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 0 -- æŸ¥è¯¢æœ‰æ•ˆçš„é€‰é¡¹

UNION ALL

-- æŸ¥è¯¢å½“å‰è¡¨å•æ›¾ç»é€‰ä¸­çš„é€‰é¡¹ï¼ˆå³ä½¿è¢«åˆ é™¤ï¼‰
SELECT o.value, o.label
FROM dropdown_options o
JOIN form_submissions f ON o.value = f.selected_value
WHERE f.form_id = :form_id
  AND o.deletedFlag = 1;

è§£é‡Šï¼š
	1.	ç¬¬ä¸€éƒ¨åˆ†æŸ¥è¯¢ï¼š
æŸ¥è¯¢æœªåˆ é™¤çš„é€‰é¡¹ï¼Œé€‚ç”¨äºæ–°è¡¨å•ã€‚
	2.	ç¬¬äºŒéƒ¨åˆ†æŸ¥è¯¢ï¼š
é€šè¿‡ JOIN å…³è” form_submissionsï¼Œæ‰¾åˆ°å½“å‰è¡¨å•é€‰ä¸­è¿‡çš„æ‰€æœ‰é€‰é¡¹ï¼Œå¹¶ä¸”å³ä½¿é€‰é¡¹å·²ç»è¢«åˆ é™¤ï¼ˆdeletedFlag = 1ï¼‰ï¼Œä¹Ÿèƒ½æ˜¾ç¤ºå‡ºæ¥ã€‚
	3.	:form_idï¼šé€šè¿‡ä¼ å…¥è¡¨å•çš„å”¯ä¸€æ ‡è¯†æ¥å…³è”æŸ¥è¯¢ã€‚
	4.	UNION ALLï¼šç¡®ä¿ç»“æœä¸ä¼šå»é‡ï¼Œé˜²æ­¢é—æ¼å·²åˆ é™¤çš„é€‰é¡¹ã€‚

ç¤ºä¾‹æ•°æ®

dropdown_options è¡¨ï¼š

value	label	deletedFlag
1	Option 1	1
2	Option 2	1
3	Option 3	0
4	Option 4	0
5	Option 5	0

form_submissions è¡¨ï¼š

form_id	selected_value
123	1
123	2

æŸ¥è¯¢ç»“æœï¼š

å‡è®¾ form_id = 123ï¼Œæ‰§è¡ŒæŸ¥è¯¢åçš„ç»“æœä¸ºï¼š

value	label
3	Option 3
4	Option 4
5	Option 5
1	Option 1
2	Option 2

ç»“æœåˆ†æï¼š
	â€¢	æ–°è¡¨å•ä¸‹æ‹‰æ¡†åªæ˜¾ç¤ºæœªåˆ é™¤çš„é€‰é¡¹ï¼ˆ3, 4, 5ï¼‰ã€‚
	â€¢	è¯¦æƒ…é¡µä¸‹æ‹‰æ¡†å¯ä»¥æ­£ç¡®æ˜¾ç¤ºå·²åˆ é™¤çš„é€‰é¡¹ï¼ˆ1, 2ï¼‰ï¼Œå¹¶ä¸”ä¸ä¼šé—æ¼ä»»ä½•ä¹‹å‰é€‰ä¸­è¿‡çš„é€‰é¡¹ã€‚

æ€»ç»“ï¼š

è¿™ä¸ªæ–¹æ¡ˆé€šè¿‡ä¸¤æ¬¡æŸ¥è¯¢ç»“åˆï¼Œä¿è¯ï¼š
	â€¢	æ–°å»ºè¡¨å• åªå±•ç¤ºæœ‰æ•ˆé€‰é¡¹ï¼›
	â€¢	æ—§è¡¨å•è¯¦æƒ…é¡µ è¿˜åŸç”¨æˆ·é€‰æ‹©çš„å…¨éƒ¨é€‰é¡¹ï¼Œæ— è®ºæ˜¯å¦å·²åˆ é™¤ï¼›
	â€¢	æŸ¥è¯¢é€»è¾‘é«˜æ•ˆï¼Œé¿å…é¢å¤–å¤„ç†å’Œå»é‡ã€‚





-- æŸ¥è¯¢æ–°è¡¨å•çš„æœ‰æ•ˆé€‰é¡¹ï¼Œåªæ˜¾ç¤º deletedFlag = 0 çš„é€‰é¡¹
SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 0

UNION ALL

-- æ ¹æ®å½“å‰è¡¨å•çš„ selected_value æŸ¥è¯¢ä¹‹å‰é€‰ä¸­çš„é€‰é¡¹ï¼ˆå³ä½¿å®ƒå·²è¢«åˆ é™¤ï¼‰
SELECT value, label
FROM dropdown_options
WHERE value = (SELECT selected_value FROM form_submissions WHERE form_id = :form_id)
  AND deletedFlag = 1;
CREATE TABLE dropdown_options (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  -- è‡ªå¢ä¸»é”®
    value VARCHAR2(255) NULL,                               -- ä¸‹æ‹‰æ¡†é€‰é¡¹çš„å€¼ï¼Œå…è®¸ç©ºå­—ç¬¦ä¸²æˆ– NULL
    label VARCHAR2(255) NULL,                               -- ä¸‹æ‹‰æ¡†é€‰é¡¹çš„æ ‡ç­¾ï¼Œå…è®¸ç©ºå­—ç¬¦ä¸²æˆ– NULL
    deletedFlag NUMBER(1) DEFAULT 0,                        -- æ ‡è®°æ˜¯å¦åˆ é™¤ï¼Œ0 è¡¨ç¤ºæœ‰æ•ˆï¼Œ1 è¡¨ç¤ºå·²åˆ é™¤
    CONSTRAINT unique_value UNIQUE (value)                  -- ç¡®ä¿ value å”¯ä¸€
);




CREATE TABLE dropdown_options (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,  -- è‡ªå¢ä¸»é”®
    value NUMBER NOT NULL,                                  -- ä¸‹æ‹‰æ¡†é€‰é¡¹çš„å€¼
    label VARCHAR2(255) NOT NULL,                           -- ä¸‹æ‹‰æ¡†é€‰é¡¹çš„æ ‡ç­¾
    deletedFlag NUMBER(1) DEFAULT 0,                        -- æ ‡è®°æ˜¯å¦åˆ é™¤ï¼Œ0 è¡¨ç¤ºæœ‰æ•ˆï¼Œ1 è¡¨ç¤ºå·²åˆ é™¤
    CONSTRAINT unique_value UNIQUE (value)                  -- ç¡®ä¿ value å”¯ä¸€
);
å¥½çš„ï¼Œå¦‚æœä½ å¸Œæœ›é€šè¿‡ SQL æ¥å¤„ç†è¿™ä¸ªéœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªç®€å•çš„æ•°æ®åº“è¡¨ï¼Œç”¨æ¥å­˜å‚¨ä¸‹æ‹‰æ¡†çš„æ•°æ®ï¼ˆlabel å’Œ valueï¼‰ï¼Œå¹¶ä¸”ç”¨ä¸€ä¸ª deletedFlag æ¥æ ‡è®°æ˜¯å¦è¯¥é€‰é¡¹å·²è¢«åˆ é™¤ã€‚

æ•°æ®è¡¨è®¾è®¡ï¼š
	1.	è¡¨åï¼šdropdown_optionsï¼ˆæˆ–ä½ å–œæ¬¢çš„åå­—ï¼‰
	2.	å­—æ®µï¼š
	â€¢	idï¼ˆä¸»é”®ï¼Œè‡ªå¢ï¼‰
	â€¢	valueï¼ˆä¸‹æ‹‰æ¡†é€‰é¡¹çš„å€¼ï¼‰
	â€¢	labelï¼ˆä¸‹æ‹‰æ¡†é€‰é¡¹çš„æ ‡ç­¾ï¼‰
	â€¢	deletedFlagï¼ˆæ ‡è®°æ˜¯å¦åˆ é™¤ï¼Œ0è¡¨ç¤ºæœ‰æ•ˆï¼Œ1è¡¨ç¤ºå·²åˆ é™¤ï¼‰

SQL è¡¨è®¾è®¡ï¼š

CREATE TABLE dropdown_options (
    id INT AUTO_INCREMENT PRIMARY KEY,  -- ä¸»é”®ï¼Œè‡ªå¢
    value INT NOT NULL,                 -- ä¸‹æ‹‰æ¡†é€‰é¡¹çš„å€¼
    label VARCHAR(255) NOT NULL,        -- ä¸‹æ‹‰æ¡†é€‰é¡¹çš„æ ‡ç­¾
    deletedFlag BOOLEAN DEFAULT 0,      -- æ ‡è®°æ˜¯å¦åˆ é™¤ï¼Œ0 è¡¨ç¤ºæœ‰æ•ˆï¼Œ1 è¡¨ç¤ºå·²åˆ é™¤
    UNIQUE(value)                       -- ä¿è¯ value æ˜¯å”¯ä¸€çš„
);

æ•°æ®æ’å…¥ç¤ºä¾‹ï¼š

-- æ’å…¥ä¸€äº›é€‰é¡¹æ•°æ®
INSERT INTO dropdown_options (value, label, deletedFlag)
VALUES
    (1, 'Option 1', 0),
    (2, 'Option 2', 0),
    (3, 'Option 3', 0),
    (4, 'Option 4', 0),
    (5, 'Option 5', 0);

-- æ ‡è®°æŸäº›é€‰é¡¹ä¸ºå·²åˆ é™¤
UPDATE dropdown_options
SET deletedFlag = 1
WHERE value = 1;  -- å‡è®¾æˆ‘ä»¬åˆ é™¤äº† Option 1

SQL æŸ¥è¯¢ï¼š

ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥è¯¢ä¸‹æ‹‰æ¡†æ•°æ®ï¼Œåªè·å–æœªè¢«åˆ é™¤çš„é€‰é¡¹ï¼Œæˆ–è€…å¦‚æœéœ€è¦åŒ…æ‹¬å·²åˆ é™¤çš„é€‰é¡¹ï¼Œä¹Ÿå¯ä»¥åšé€‚å½“çš„è°ƒæ•´ã€‚
	1.	æŸ¥è¯¢æ‰€æœ‰æœ‰æ•ˆçš„ä¸‹æ‹‰é€‰é¡¹ï¼ˆæœªåˆ é™¤çš„ï¼‰ï¼š

SELECT value, label
FROM dropdown_options
WHERE deletedFlag = 0;

	2.	æŸ¥è¯¢æ‰€æœ‰ä¸‹æ‹‰é€‰é¡¹ï¼ˆåŒ…æ‹¬å·²åˆ é™¤çš„ï¼‰ï¼š

SELECT value, label, deletedFlag
FROM dropdown_options;

ç»“åˆä½ çš„éœ€æ±‚ï¼š

å‡è®¾ä½ å¸Œæœ›åœ¨è¡¨å•åŠ è½½æ—¶å°†ä¸‹æ‹‰æ¡†çš„æ•°æ®å¡«å……åˆ°å‰ç«¯ï¼Œå¹¶ä¸”å¦‚æœç”¨æˆ·é€‰æ‹©çš„æ˜¯å·²åˆ é™¤çš„é€‰é¡¹ï¼ˆä¾‹å¦‚ï¼Œvalue = 1ï¼‰ï¼Œä½ å¸Œæœ›æ˜¾ç¤ºè¯¥é€‰é¡¹ï¼Œå¹¶æ ‡è®°ä¸ºâ€œå·²åˆ é™¤â€è€Œä¸ç¦ç”¨å®ƒï¼Œå¯ä»¥ä½¿ç”¨ç±»ä¼¼ä»¥ä¸‹æ–¹å¼æ¥æŸ¥è¯¢ï¼š
	1.	è·å–ä¸‹æ‹‰æ¡†æ•°æ®ï¼šå¯ä»¥é€šè¿‡æŸ¥è¯¢æ•°æ®åº“æ¥è·å– value å’Œ labelï¼Œå¹¶ä¸”åŒ…æ‹¬å·²åˆ é™¤çš„é€‰é¡¹ã€‚
	2.	æ˜¾ç¤ºå·²åˆ é™¤çš„é€‰é¡¹ï¼šå‰ç«¯å¯ä»¥æ ¹æ®æŸ¥è¯¢ç»“æœæ¥å¤„ç†æ˜¾ç¤ºï¼Œå¹¶é€šè¿‡ deletedFlag å­—æ®µæ¥åˆ¤æ–­è¯¥é€‰é¡¹æ˜¯å¦å·²åˆ é™¤ã€‚

åç«¯å¤„ç†ï¼š

å‡è®¾ä½ æœ‰ä¸€ä¸ªåç«¯ APIï¼Œè´Ÿè´£ä»æ•°æ®åº“ä¸­è·å–ä¸‹æ‹‰æ¡†çš„æ•°æ®ï¼Œè¿”å›ç»™å‰ç«¯ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨ PHPã€Node.js æˆ– Java ç­‰åç«¯è¯­è¨€ï¼Œå¯ä»¥ä½¿ç”¨ä¸Šé¢çš„ SQL æŸ¥è¯¢è¯­å¥æ¥è·å–æ•°æ®ã€‚

ç¤ºä¾‹ï¼šç”¨ PHP è·å–æ•°æ®å¹¶è¿”å›ç»™å‰ç«¯ï¼ˆç®€åŒ–ç‰ˆï¼‰

<?php
// å‡è®¾ä½ å·²ç»è¿æ¥åˆ°æ•°æ®åº“
$sql = "SELECT value, label FROM dropdown_options WHERE deletedFlag = 0";
$result = $conn->query($sql);

$options = [];
while ($row = $result->fetch_assoc()) {
    $options[] = $row;
}

// è¾“å‡º JSON æ ¼å¼çš„é€‰é¡¹æ•°æ®
echo json_encode($options);
?>

ç¤ºä¾‹ï¼šç”¨ Node.js è·å–æ•°æ®å¹¶è¿”å›ç»™å‰ç«¯ï¼ˆç®€åŒ–ç‰ˆï¼‰

const express = require('express');
const app = express();
const mysql = require('mysql');

// åˆ›å»ºæ•°æ®åº“è¿æ¥
const db = mysql.createConnection({
  host: 'localhost',
  user: 'root',
  password: '',
  database: 'your_database'
});

app.get('/dropdown-options', (req, res) => {
  const query = 'SELECT value, label FROM dropdown_options WHERE deletedFlag = 0';
  db.query(query, (err, results) => {
    if (err) {
      res.status(500).send(err);
    } else {
      res.json(results);
    }
  });
});

app.listen(3000, () => {
  console.log('Server is running on http://localhost:3000');
});

å‰ç«¯å¤„ç†ï¼š

åœ¨å‰ç«¯ï¼Œä½ å¯ä»¥é€šè¿‡ AJAX æˆ– Fetch è¯·æ±‚è·å–ä¸‹æ‹‰æ¡†æ•°æ®ï¼Œå¹¶æ ¹æ®è¿”å›çš„ deletedFlag æ¥å†³å®šå¦‚ä½•æ˜¾ç¤ºå·²åˆ é™¤çš„é€‰é¡¹ã€‚

$(document).ready(function() {
    // å‡è®¾ä½ æœ‰ä¸€ä¸ª API è¿”å›ä¸‹æ‹‰æ¡†æ•°æ®
    $.ajax({
        url: '/dropdown-options',  // æ ¹æ®ä½ çš„ API åœ°å€è°ƒæ•´
        method: 'GET',
        success: function(data) {
            var selectedValue = 1; // å‡è®¾ç”¨æˆ·é€‰æ‹©çš„æ˜¯ Option 1
            var $select = $('#programme');

            // æ¸…ç©ºä¸‹æ‹‰æ¡†
            $select.empty();

            data.forEach(function(option) {
                var label = option.label;
                if (option.deletedFlag === 1) {
                    label += ' (å·²åˆ é™¤)'; // æ ‡è®°ä¸ºå·²åˆ é™¤
                }

                var isSelected = option.value === selectedValue ? 'selected' : '';
                $select.append('<option value="' + option.value + '" ' + isSelected + '>' + label + '</option>');
            });
        }
    });
});

æ€»ç»“ï¼š
	1.	æ•°æ®åº“è®¾è®¡ï¼šé€šè¿‡åˆ›å»ºä¸€ä¸ªåŒ…å« valueã€label å’Œ deletedFlag å­—æ®µçš„è¡¨ï¼Œæ¥å­˜å‚¨ä¸‹æ‹‰æ¡†çš„æ•°æ®ã€‚
	2.	SQL æŸ¥è¯¢ï¼šå¯ä»¥æ ¹æ® deletedFlag æ¥æŸ¥è¯¢æœ‰æ•ˆçš„é€‰é¡¹ï¼Œæˆ–è€…åŒ…æ‹¬æ‰€æœ‰é€‰é¡¹ã€‚
	3.	åç«¯å¤„ç†ï¼šåç«¯æ ¹æ® SQL æŸ¥è¯¢è·å–æ•°æ®ï¼Œè¿”å›ç»™å‰ç«¯ã€‚
	4.	å‰ç«¯å¤„ç†ï¼šå‰ç«¯æ ¹æ® deletedFlag æ¥æ˜¾ç¤ºé€‰é¡¹ï¼Œå¹¶æ ‡è®°å·²åˆ é™¤çš„é€‰é¡¹ã€‚

è¿™æ ·ï¼Œä½ å°±èƒ½é€šè¿‡æ•°æ®åº“ç®¡ç†ä¸‹æ‹‰æ¡†çš„æ•°æ®ï¼Œå¹¶åŠ¨æ€åŠ è½½å¹¶æ˜¾ç¤ºè¿™äº›æ•°æ®ã€‚




$(document).ready(function() {
    // å‡è®¾è¿™æ˜¯ç”¨æˆ·åŸå…ˆé€‰æ‹©çš„å€¼
    var selectedValue = 1;  // å‡è®¾ç”¨æˆ·é€‰æ‹©äº† Option 1ï¼Œä½†å®ƒå·²è¢«åˆ é™¤

    // å½“å‰çš„é€‰é¡¹åˆ—è¡¨ï¼Œå…¶ä¸­åŒ…å« deleted å±æ€§
    var options = [
        { value: 1, label: "Option 1", deleted: true },
        { value: 2, label: "Option 2", deleted: false },
        { value: 3, label: "Option 3", deleted: false },
        { value: 4, label: "Option 4", deleted: false },
        { value: 5, label: "Option 5", deleted: false }
    ];

    // è·å–ä¸‹æ‹‰æ¡† <select> å…ƒç´ 
    var $select = $('#programme');

    // å…ˆæ¸…ç©ºä¸‹æ‹‰æ¡†
    $select.empty();

    // éå† optionsï¼Œå¤„ç†å·²åˆ é™¤çš„é€‰é¡¹
    options.forEach(function(option) {
        // å¦‚æœé€‰é¡¹å·²åˆ é™¤å¹¶ä¸”æ˜¯ç”¨æˆ·é€‰ä¸­çš„é€‰é¡¹
        if (option.deleted && option.value === selectedValue) {
            // å°†å·²åˆ é™¤çš„é€‰é¡¹æ’å…¥ï¼Œå¹¶åœ¨ label ä¸­æ˜¾ç¤ºâ€œå·²åˆ é™¤â€
            $select.append('<option value="' + option.value + '" selected>' + option.label + ' (å·²åˆ é™¤)</option>');
        }
        // å¦‚æœé€‰é¡¹æ²¡æœ‰è¢«åˆ é™¤ï¼Œæ­£å¸¸æ˜¾ç¤ºå®ƒ
        else if (!option.deleted) {
            var isSelected = option.value === selectedValue ? 'selected' : '';
            $select.append('<option value="' + option.value + '" ' + isSelected + '>' + option.label + '</option>');
        }
    });
});





let selectedValue = getSelectedValueFromDatabase(); // ä»æ•°æ®åº“ä¸­å–å‡ºé€‰ä¸­çš„å€¼

let options = [
  { value: 1, label: "Option 1", deleted: true },
  { value: 2, label: "Option 2", deleted: false },
  { value: 3, label: "Option 3", deleted: false },
  { value: 4, label: "Option 4", deleted: false },
  { value: 5, label: "Option 5", deleted: false }
];

// æ¸²æŸ“ä¸‹æ‹‰æ¡†æ—¶ï¼Œæ‰‹åŠ¨æ·»åŠ å·²åˆ é™¤çš„é€‰é¡¹
options.forEach(option => {
  if (option.value === selectedValue) {
    // å¦‚æœå½“å‰é€‰é¡¹å·²åˆ é™¤ï¼Œä¸”è¯¥å€¼æ˜¯ç”¨æˆ·çš„é€‰æ‹©ï¼Œåˆ™å°†å…¶ç¦ç”¨å¹¶é€‰ä¸­
    if (option.deleted) {
      document.querySelector('select').innerHTML += `<option value="${option.value}" disabled selected>${option.label} (å·²åˆ é™¤)</option>`;
    } else {
      document.querySelector('select').innerHTML += `<option value="${option.value}" selected>${option.label}</option>`;
    }
  } else {
    // æ­£å¸¸çš„æœªåˆ é™¤é€‰é¡¹
    document.querySelector('select').innerHTML += `<option value="${option.value}">${option.label}</option>`;
  }
});
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Horizontal Scrollbar</title>
  <style>
    /* æ¨ªå‘æ»šåŠ¨æ¡çš„çˆ¶å®¹å™¨æ ·å¼ */
    .horizontal-scrollbar {
      width: 300px;   /* å®½åº¦é™åˆ¶ */
      height: 150px;  /* é«˜åº¦é™åˆ¶ */
      overflow-x: auto; /* å¯ç”¨æ¨ªå‘æ»šåŠ¨æ¡ */
      overflow-y: hidden; /* ç¦ç”¨å‚ç›´æ»šåŠ¨æ¡ */
      white-space: nowrap; /* é˜²æ­¢å†…å®¹æ¢è¡Œï¼Œå¼ºåˆ¶æ¨ªå‘æ»šåŠ¨ */
      border: 1px solid #ccc; /* è¾¹æ¡† */
    }

    /* è‡ªå®šä¹‰æ¨ªå‘æ»šåŠ¨æ¡æ ·å¼ */
    .horizontal-scrollbar::-webkit-scrollbar {
      height: 16px; /* æ¨ªå‘æ»šåŠ¨æ¡é«˜åº¦ */
    }

    /* æ»‘å—æ ·å¼ */
    .horizontal-scrollbar::-webkit-scrollbar-thumb {
      background: #b0b0b0; /* æ»‘å—é¢œè‰² */
      border-radius: 8px; /* æ»‘å—åœ†è§’ */
    }

    /* æ»‘å—æ‚¬åœæ•ˆæœ */
    .horizontal-scrollbar::-webkit-scrollbar-thumb:hover {
      background: #909090; /* æ»‘å—æ‚¬åœæ—¶çš„é¢œè‰² */
    }

    /* æ»šåŠ¨æ¡è½¨é“æ ·å¼ */
    .horizontal-scrollbar::-webkit-scrollbar-track {
      background: #f0f0f0; /* æ»‘é“é¢œè‰² */
    }

    /* å·¦ç®­å¤´æŒ‰é’® */
    .horizontal-scrollbar::-webkit-scrollbar-button:single-button:decrement {
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="gray"><polygon points="6,4 10,8 6,12"/></svg>') no-repeat center;
      background-size: 8px 8px;
    }

    /* å³ç®­å¤´æŒ‰é’® */
    .horizontal-scrollbar::-webkit-scrollbar-button:single-button:increment {
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="gray"><polygon points="10,4 6,8 10,12"/></svg>') no-repeat center;
      background-size: 8px 8px;
    }

    /* ç¦ç”¨æŒ‰é’®ï¼ˆæ»šåŠ¨åˆ°æœ€å·¦æˆ–æœ€å³æ—¶ï¼‰ */
    .horizontal-scrollbar::-webkit-scrollbar-button:disabled {
      background: #f0f0f0;
    }
  </style>
</head>
<body>
  <h1>æ™®é€šå†…å®¹</h1>
  <p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¸¦æœ‰è‡ªå®šä¹‰æ¨ªå‘æ»šåŠ¨æ¡çš„å®¹å™¨ï¼š</p>

  <!-- æ¨ªå‘æ»šåŠ¨æ¡çš„å®¹å™¨ -->
  <div class="horizontal-scrollbar">
    <div style="display: inline-block; width: 800px; height: 100%; background: linear-gradient(to right, #ff9a9e, #fad0c4);">
      è¿™æ˜¯ä¸€ä¸ªå®½å†…å®¹åŒºåŸŸï¼Œæ¨¡æ‹Ÿæ¨ªå‘æ»šåŠ¨æ¡çš„æ•ˆæœã€‚å‘å³æ»šåŠ¨ä»¥æŸ¥çœ‹æ›´å¤šå†…å®¹ã€‚
    </div>
  </div>
</body>
</html>
SELECT TRIM(BOTH ',' FROM 
           CASE WHEN field1 IS NOT NULL THEN field1 || ',' ELSE '' END ||
           CASE WHEN field2 IS NOT NULL THEN field2 || ',' ELSE '' END ||
           CASE WHEN field3 IS NOT NULL THEN field3 || ',' ELSE '' END ||
           CASE WHEN field4 IS NOT NULL THEN field4 || ',' ELSE '' END ||
           CASE WHEN field5 IS NOT NULL THEN field5 || ',' ELSE '' END
       ) AS combined_fields
FROM my_table;

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Custom Scrollbar</title>
  <style>
    /* çˆ¶å®¹å™¨æ ·å¼ */
    .scrollable {
      width: 300px;
      height: 200px;
      overflow: auto; /* å¯ç”¨æ»šåŠ¨æ¡ */
      border: 1px solid #ccc;
    }

    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
    /* æ•´ä½“æ»šåŠ¨æ¡ */
    ::-webkit-scrollbar {
      width: 16px; /* å‚ç›´æ»šåŠ¨æ¡å®½åº¦ */
      height: 16px; /* æ°´å¹³æ»šåŠ¨æ¡é«˜åº¦ */
    }

    /* æ»šåŠ¨æ¡æ»‘å— */
    ::-webkit-scrollbar-thumb {
      background: #b0b0b0; /* æ»‘å—é¢œè‰² */
      border-radius: 8px; /* æ»‘å—åœ†è§’ */
    }

    /* æ»‘å—æ‚¬åœæ•ˆæœ */
    ::-webkit-scrollbar-thumb:hover {
      background: #909090; /* æ»‘å—æ‚¬åœæ—¶é¢œè‰² */
    }

    /* æ»šåŠ¨æ¡è½¨é“ */
    ::-webkit-scrollbar-track {
      background: #f0f0f0; /* æ»‘é“é¢œè‰² */
    }

    /* ä¸Šä¸‹ç®­å¤´æŒ‰é’®æ ·å¼ */
    ::-webkit-scrollbar-button {
      background: #e0e0e0; /* æŒ‰é’®èƒŒæ™¯è‰² */
      border: none; /* å»æ‰è¾¹æ¡† */
    }

    /* ä¸Šç®­å¤´æŒ‰é’® */
    ::-webkit-scrollbar-button:single-button:decrement {
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="gray"><polygon points="8,4 4,10 12,10"/></svg>') no-repeat center;
      background-size: 8px 8px;
    }

    /* ä¸‹ç®­å¤´æŒ‰é’® */
    ::-webkit-scrollbar-button:single-button:increment {
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="gray"><polygon points="4,6 12,6 8,12"/></svg>') no-repeat center;
      background-size: 8px 8px;
    }

    /* ç¦ç”¨çš„æŒ‰é’®ï¼ˆæ»šåŠ¨åˆ°æœ€é¡¶éƒ¨/åº•éƒ¨æ—¶ï¼‰ */
    ::-webkit-scrollbar-button:disabled {
      background: #f0f0f0; /* ç¦ç”¨æŒ‰é’®çš„èƒŒæ™¯è‰² */
    }

    /* æ°´å¹³æ–¹å‘å·¦å³ç®­å¤´æŒ‰é’®æ ·å¼ï¼ˆå¯é€‰ï¼‰ */
    ::-webkit-scrollbar-button:horizontal:decrement {
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="gray"><polygon points="6,4 10,8 6,12"/></svg>') no-repeat center;
      background-size: 8px 8px;
    }

    ::-webkit-scrollbar-button:horizontal:increment {
      background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="gray"><polygon points="10,4 6,8 10,12"/></svg>') no-repeat center;
      background-size: 8px 8px;
    }
  </style>
</head>
<body>
  <div class="scrollable">
    <!-- æ¨¡æ‹Ÿå†…å®¹ä»¥è§¦å‘æ»šåŠ¨æ¡ -->
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque ultricies dui quis sapien pulvinar, non aliquet felis laoreet. Curabitur a velit quis ex dictum sagittis. Praesent nec mauris a dui luctus volutpat. Etiam eget accumsan urna, nec fermentum nulla. Nam sit amet nulla in justo viverra dignissim. Pellentesque gravida tortor vitae justo blandit, et fermentum lacus bibendum. Nam dapibus a eros nec aliquam. Cras vehicula nunc nec nunc luctus, nec dapibus nulla tempor.</p>
    <p>Fusce sit amet massa arcu. Integer in sodales eros. Nam vel nibh vehicula, dignissim felis nec, dapibus erat. Morbi varius tellus eu lectus efficitur, eget sollicitudin magna tristique. Donec pellentesque fringilla turpis ut consectetur. Suspendisse scelerisque posuere ipsum a eleifend. Suspendisse potenti. Curabitur ultricies libero orci, id feugiat sapien rutrum a.</p>
    <p>Aenean malesuada orci quis sapien eleifend, vitae tempor purus euismod. Nullam sed metus et mauris posuere pretium. Suspendisse potenti. Sed varius vestibulum lectus, eget fringilla neque. Suspendisse id purus non ligula congue pharetra. Maecenas vehicula felis et est dictum auctor. Proin maximus fringilla urna, et molestie ligula malesuada sed. Suspendisse tincidunt lorem vitae metus feugiat, quis feugiat purus fringilla.</p>
  </div>
</body>
</ä»¥ä¸‹æ˜¯ç”¨ HTMLã€jQuery å’Œ Oracle å®ç°çš„è§£å†³æ–¹æ¡ˆï¼š

1. HTML ä»£ç 

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Approval Table</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>
    <div>
        <label>
            <input type="checkbox" id="approvalCheckbox" checked> æŸ¥è¯¢æœªå®¡æ‰¹(U)
        </label>
        <button id="searchButton">Search</button>
    </div>

    <table border="1" id="approvalTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Approval</th>
            </tr>
        </thead>
        <tbody>
            <!-- æŸ¥è¯¢ç»“æœä¼šåŠ¨æ€æ’å…¥åˆ°è¿™é‡Œ -->
        </tbody>
    </table>

    <script>
        $(document).ready(function () {
            function fetchData(approvalFilter) {
                $.ajax({
                    url: '/fetchApprovalData',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ approval: approvalFilter }),
                    success: function (response) {
                        const tableBody = $("#approvalTable tbody");
                        tableBody.empty(); // æ¸…ç©ºè¡¨æ ¼
                        response.forEach(row => {
                            tableBody.append(`
                                <tr>
                                    <td>${row.ID}</td>
                                    <td>${row.Name}</td>
                                    <td>${row.Approval}</td>
                                </tr>
                            `);
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error("Error fetching data:", error);
                    }
                });
            }

            // é»˜è®¤æŸ¥è¯¢ U
            fetchData(['U']);

            // ç‚¹å‡»æœç´¢æŒ‰é’®äº‹ä»¶
            $("#searchButton").on("click", function () {
                const isChecked = $("#approvalCheckbox").is(":checked");
                const approvalFilter = isChecked ? ['U'] : ['A', 'D'];
                fetchData(approvalFilter);
            });
        });
    </script>
</body>
</html>

2. Oracle æ•°æ®åº“æŸ¥è¯¢

å‡è®¾è¡¨åä¸º ApprovalTableï¼Œä»¥ä¸‹æ˜¯åç«¯ä½¿ç”¨çš„ SQL æŸ¥è¯¢ï¼š

-- æŸ¥è¯¢ Approval ä¸º U çš„æ•°æ®
SELECT ID, Name, Approval 
FROM ApprovalTable
WHERE Approval = 'U';

-- æŸ¥è¯¢ Approval ä¸º A å’Œ D çš„æ•°æ®
SELECT ID, Name, Approval 
FROM ApprovalTable
WHERE Approval IN ('A', 'D');

3. åç«¯å®ç°ç¤ºä¾‹ (Node.js ä¸ºä¾‹)

const express = require('express');
const oracledb = require('oracledb');
const bodyParser = require('body-parser');

const app = express();
app.use(bodyParser.json());

// Oracle æ•°æ®åº“é…ç½®
const dbConfig = {
    user: 'your_username',
    password: 'your_password',
    connectString: 'your_database_connection_string'
};

// è·¯ç”±å¤„ç†
app.post('/fetchApprovalData', async (req, res) => {
    const { approval } = req.body;

    const query = `
        SELECT ID, Name, Approval 
        FROM ApprovalTable
        WHERE Approval IN (:approval)
    `;

    try {
        const connection = await oracledb.getConnection(dbConfig);
        const result = await connection.execute(query, { approval }, { outFormat: oracledb.OUT_FORMAT_OBJECT });
        await connection.close();
        res.json(result.rows);
    } catch (err) {
        console.error("Database query error:", err);
        res.status(500).send("Internal Server Error");
    }
});

// å¯åŠ¨æœåŠ¡å™¨
app.listen(3000, () => {
    console.log("Server is running on http://localhost:3000");
});

åŠŸèƒ½è¯´æ˜
	1.	å‰ç«¯é€»è¾‘ï¼š
	â€¢	é¡µé¢åŠ è½½æ—¶é»˜è®¤æŸ¥è¯¢ Approval ä¸º U çš„æ•°æ®ã€‚
	â€¢	ç”¨æˆ·å¯ä»¥åˆ‡æ¢å¤é€‰æ¡†çŠ¶æ€å¹¶ç‚¹å‡»æœç´¢æŒ‰é’®æ¥æŸ¥è¯¢ Approval ä¸º A å’Œ D çš„æ•°æ®ã€‚
	2.	åç«¯å¤„ç†ï¼š
	â€¢	æ¥æ”¶å‰ç«¯ä¼ é€’çš„ approval æ•°ç»„å‚æ•°ã€‚
	â€¢	æ ¹æ® IN æ¡ä»¶è¿‡æ»¤ Approval å­—æ®µçš„æ•°æ®ã€‚
	3.	åŠ¨æ€æ›´æ–°è¡¨æ ¼ï¼š
	â€¢	ä½¿ç”¨ AJAX è¯·æ±‚è·å–åç«¯æ•°æ®ï¼Œå¹¶åŠ¨æ€æ’å…¥åˆ°è¡¨æ ¼ä¸­ã€‚
	4.	æ•°æ®åº“æ“ä½œï¼š
	â€¢	æŸ¥è¯¢è¯­å¥ä½¿ç”¨ç»‘å®šå˜é‡æ¥é˜²æ­¢ SQL æ³¨å…¥ã€‚

ä½ å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚å¯¹ä»£ç è¿›è¡Œè°ƒæ•´ï¼Œæ¯”å¦‚é…ç½®å…·ä½“çš„æ•°æ®åº“è¿æ¥å’Œæ ·å¼ä¼˜åŒ–ã€‚

